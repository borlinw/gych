<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.gych.sjjs">
	
	<select id="selectHjchList" parameterType="hjch" resultType="hjch">
		select * from (
		select m.*,rownum rn from (
			select id,whnf,whbh,'广测汇凭字（20'||whnf||'）第'||whbh||'号' hjwh,hjdw,lxdh,chxmmc,chxmszd,scdw,wcsj,zljcysdw,jcyssj,
  				   hjchcgfbhmlsl,hjchcgfbhmlxxnr,a1,a2,a3,a4,a5,b1,b2,b3,b4,b5,c1,c2,c3,c4,c5,
  				   hjrqm,jsrqm,hjjsn,hjjsy,hjjsr,qzn,qzy,qzr
			 from HJCH t
		     where 1=1
		<if test="chxmmc != null and  chxmmc != ''">
		and chxmmc like '%'||#{chxmmc}||'%'
		</if>
		<if test="hjdw != null and  hjdw != ''">
		and hjdw like '%'||#{hjdw}||'%'
		</if>
		<if test="kssj != null and  kssj  != ''">
		and wcsj>=  #{kssj}
		</if>
		<if test="jssj != null and  jssj  != ''">
		and #{jssj}>=  wcsj
		</if>
		order by whnf||whbh
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectHjchListCount" parameterType="hjch" resultType="int">
		select count(*) from HJCH 
		where 1=1
		<if test="chxmmc != null and  chxmmc != ''">
		and chxmmc like '%'||#{chxmmc}||'%'
		</if>
		<if test="hjdw != null and  hjdw != ''">
		and hjdw like '%'||#{hjdw}||'%'
		</if>
		<if test="kssj != null and  kssj  != ''">
		and wcsj>=  #{kssj}
		</if>
		<if test="jssj != null and  jssj  != ''">
		and #{jssj}>=  wcsj
		</if>
	</select>

	<insert id="insertHjch" parameterType="hjch">
		insert into hjch(id,whnf,whbh,hjdw,lxdh,chxmmc,chxmszd,scdw,wcsj,  zljcysdw,jcyssj,
        hjchcgfbhmlsl,hjchcgfbhmlxxnr 
       ,a1,a2,a3,a4,a5,b1,b2,b3,b4,b5,c1,c2,c3,c4,c5,
        hjrqm,jsrqm,hjjsn,hjjsy,hjjsr,qzn,qzy,qzr )
		values (SYS_GUID(),#{whnf},#{whbh},#{hjdw},#{lxdh},#{chxmmc},#{chxmszd},#{scdw},#{wcsj}, #{zljcysdw},
		#{jcyssj},#{hjchcgfbhmlsl},#{hjchcgfbhmlxxnr}
		,#{a1},#{a2},#{a3},#{a4},#{a5},#{b1},#{b2},#{b3},#{b4},#{b5},#{c1},#{c2}
		,#{c3},#{c4},#{c5},#{hjrqm},#{jsrqm},#{hjjsn},#{hjjsy},#{hjjsr},#{qzn},#{qzy},#{qzr} )
	</insert>
	
	<delete id="deleteHjch" parameterType="String">
		delete from HJCH where id=#{id}
	</delete>
	<update id="updateHjch" parameterType="hjch">
		update HJCH set whnf=#{whnf},whbh=#{whbh},hjdw=#{hjdw},lxdh=#{lxdh},chxmmc=#{chxmmc},chxmszd=#{chxmszd},scdw=#{scdw},
		wcsj=#{wcsj},  zljcysdw=#{zljcysdw},jcyssj=#{jcyssj},
        hjchcgfbhmlsl=#{hjchcgfbhmlsl},hjchcgfbhmlxxnr=#{hjchcgfbhmlxxnr},
        a1=#{a1},a2=#{a2},a3=#{a3},a4=#{a4},a5=#{a5},b1=#{b1},b2=#{b2},b3=#{b3},b4=#{b4},b5=#{b5},
        c1=#{c1},c2=#{c2},c3=#{c3},c4=#{c4},c5=#{c5},
        hjrqm=#{hjrqm},jsrqm=#{jsrqm},hjjsn=#{hjjsn},hjjsy=#{hjjsy},hjjsr=#{hjjsr},qzn=#{qzn},qzy=#{qzy},qzr=#{qzr}
		where id=#{id}
	</update>
	
	<select id="selectHjchById2" parameterType="hjch" resultType="hashmap">

			SELECT ID A0,WHNF A1,WHBH A2,HJDW A3,LXDH A4,CHXMMC A5,CHXMSZD A6,SCDW A7,WCSJ A8,
			ZLJCYSDW A9,JCYSSJ A10,
  				   HJCHCGFBHMLSL A11,HJCHCGFBHMLXXNR A12,A1 A13,A2 A14,A3 A15,A4 A16,A5 A17,B1 A18,
  				   B2 A19,B3 A20,B4 A21,B5 A22,C1 A23,C2 A24,C3 A25,C4 A26,C5 A27,
  				   HJRQM,JSRQM,HJJSN,HJJSY,HJJSR,QZN,QZY,QZR
			 FROM HJCH T
		     WHERE ID=#{id}
    </select>
	
</mapper>
